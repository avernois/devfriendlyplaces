<meta charset=UTF-8>
<title>Document</title>
<link rel=stylesheet href=https://unpkg.com/leaflet@1.0.3/dist/leaflet.css >
<link rel=stylesheet href=devfriendly.css >
<script src=https://unpkg.com/leaflet@1.0.3/dist/leaflet.js></script>
<script src=devfriendly.js></script>

<div id=map></div>

<script>
    var map = L.map('map').setView([43.610769, 3.876716], 13)
    L.tileLayer('http://{s}.tile.osm.org/{z}/{x}/{y}.png', {
        attribution: '&copy; <a href=http://osm.org/copyright>OpenStreetMap</a> contributors'
    }).addTo(map)

    const app = Elm.Devfriendly.fullscreen()

    app.ports.moveMap.subscribe(
       (townAndPlaces) => {
               const town = townAndPlaces[0]
               const places = townAndPlaces[1] 
               map.setView([town.latitude, town.longitude], town.defaultZoom)
               
               places.map( place => {
                    L.marker([place.latitude, place.longitude]).addTo(map)
                        .bindPopup(place.name)
               })
           })
</script>
